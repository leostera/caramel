<!DOCTYPE HTML>
<html lang="en" class="sidebar-visible no-js ayu">
    <head>
        
        <!-- Google Analytics Tag -->
        <script type="text/javascript">
            var localAddrs = ["localhost", "127.0.0.1", ""];

            // make sure we don't activate google analytics if the developer is
            // inspecting the book locally...
            if (localAddrs.indexOf(document.location.hostname) === -1) {
                (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
                (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
                m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
                })(window,document,'script','https://www.google-analytics.com/analytics.js','ga');

                ga('create', 'G-HVSX9MBNEJ', 'auto');
                ga('send', 'pageview');
            }
        </script>
        

        <!-- Book generated using mdBook -->
        <meta charset="UTF-8">
        <title>Caramel Manual</title>
        
        <meta name="robots" content="noindex" />
        
        


        <!-- Custom HTML head -->
        


        <meta content="text/html; charset=utf-8" http-equiv="Content-Type">
        <meta name="description" content="Caramel is a compiler to write safe, concurrent, massively scalable systems for the BEAM, in OCaml">
        <meta name="viewport" content="width=device-width, initial-scale=1">
        <meta name="theme-color" content="#ffffff" />

        
        <link rel="icon" href="favicon.svg">
        
        
        <link rel="shortcut icon" href="favicon.png">
        
        <link rel="stylesheet" href="css/variables.css">
        <link rel="stylesheet" href="css/general.css">
        <link rel="stylesheet" href="css/chrome.css">
        
        <link rel="stylesheet" href="css/print.css" media="print">
        

        <!-- Fonts -->
        <link rel="stylesheet" href="FontAwesome/css/font-awesome.css">
        
        <link rel="stylesheet" href="fonts/fonts.css">
        

        <!-- Highlight.js Stylesheets -->
        <link rel="stylesheet" href="highlight.css">
        <link rel="stylesheet" href="tomorrow-night.css">
        <link rel="stylesheet" href="ayu-highlight.css">

        <!-- Custom theme stylesheets -->
        

        
    </head>
    <body>
        <!-- Provide site root to javascript -->
        <script type="text/javascript">
            var path_to_root = "";
            var default_theme = window.matchMedia("(prefers-color-scheme: dark)").matches ? "ayu" : "ayu";
        </script>

        <!-- Work around some values being stored in localStorage wrapped in quotes -->
        <script type="text/javascript">
            try {
                var theme = localStorage.getItem('mdbook-theme');
                var sidebar = localStorage.getItem('mdbook-sidebar');

                if (theme.startsWith('"') && theme.endsWith('"')) {
                    localStorage.setItem('mdbook-theme', theme.slice(1, theme.length - 1));
                }

                if (sidebar.startsWith('"') && sidebar.endsWith('"')) {
                    localStorage.setItem('mdbook-sidebar', sidebar.slice(1, sidebar.length - 1));
                }
            } catch (e) { }
        </script>

        <!-- Set the theme before any content is loaded, prevents flash -->
        <script type="text/javascript">
            var theme;
            try { theme = localStorage.getItem('mdbook-theme'); } catch(e) { }
            if (theme === null || theme === undefined) { theme = default_theme; }
            var html = document.querySelector('html');
            html.classList.remove('no-js')
            html.classList.remove('ayu')
            html.classList.add(theme);
            html.classList.add('js');
        </script>

        <!-- Hide / unhide sidebar before it is displayed -->
        <script type="text/javascript">
            var html = document.querySelector('html');
            var sidebar = 'hidden';
            if (document.body.clientWidth >= 1080) {
                try { sidebar = localStorage.getItem('mdbook-sidebar'); } catch(e) { }
                sidebar = sidebar || 'visible';
            }
            html.classList.remove('sidebar-visible');
            html.classList.add("sidebar-" + sidebar);
        </script>

        <nav id="sidebar" class="sidebar" aria-label="Table of contents">
            <div class="sidebar-scrollbox">
              <h2 style="margin-top: 1rem;">
                <img width="32px" src="/assets/isotype.png"> </img> Caramel Manual
              </h2>
                <ol class="chapter"><li class="chapter-item expanded "><a href="introduction.html"><strong aria-hidden="true">1.</strong> Introduction</a></li><li class="chapter-item expanded "><a href="getting-started/index.html"><strong aria-hidden="true">2.</strong> Getting Started</a></li><li><ol class="section"><li class="chapter-item expanded "><a href="getting-started/installation.html"><strong aria-hidden="true">2.1.</strong> Installation</a></li><li class="chapter-item expanded "><a href="getting-started/first-steps.html"><strong aria-hidden="true">2.2.</strong> First Steps</a></li></ol></li><li class="chapter-item expanded "><a href="changelog/v0.1.0.html"><strong aria-hidden="true">3.</strong> CHANGELOG</a></li><li><ol class="section"><li class="chapter-item expanded "><a href="changelog/v0.1.0.html"><strong aria-hidden="true">3.1.</strong> v0.1.0</a></li><li class="chapter-item expanded "><a href="changelog/v0.0.14.html"><strong aria-hidden="true">3.2.</strong> v0.0.14</a></li><li class="spacer"></li></ol></li><li class="chapter-item expanded "><a href="guides/index.html"><strong aria-hidden="true">4.</strong> Guides</a></li><li><ol class="section"><li class="chapter-item expanded "><a href="guides/syntax-cheatsheet.html"><strong aria-hidden="true">4.1.</strong> Syntax Cheatsheet</a></li><li class="chapter-item expanded "><a href="guides/caramel-rebar3.html"><strong aria-hidden="true">4.2.</strong> Using Caramel with Rebar3</a></li><li class="chapter-item expanded "><a href="guides/caramel-mix.html"><strong aria-hidden="true">4.3.</strong> Using Caramel with Mix</a></li><li class="chapter-item expanded "><a href="guides/caramel-mix.html"><strong aria-hidden="true">4.4.</strong> Using Caramel with Zap</a></li><li class="chapter-item expanded "><a href="guides/erlang-ffi.html"><strong aria-hidden="true">4.5.</strong> Calling Erlang code</a></li><li class="chapter-item expanded "><a href="guides/elixir-ffi.html"><strong aria-hidden="true">4.6.</strong> Calling Elixir code</a></li></ol></li><li class="chapter-item expanded "><a href="examples/index.html"><strong aria-hidden="true">5.</strong> Examples</a></li><li><ol class="section"><li class="chapter-item expanded "><a href="examples/hello-joe.html"><strong aria-hidden="true">5.1.</strong> Hello, Joe!</a></li><li class="chapter-item expanded "><a href="examples/simple-http-echo-server.html"><strong aria-hidden="true">5.2.</strong> Simple HTTP Echo Server</a></li><li class="spacer"></li></ol></li><li class="chapter-item expanded "><a href="reference/index.html"><strong aria-hidden="true">6.</strong> Reference</a></li><li><ol class="section"><li class="chapter-item expanded "><a href="reference/cli/default.html"><strong aria-hidden="true">6.1.</strong> Caramel CLI</a></li><li><ol class="section"><li class="chapter-item expanded "><a href="reference/cli/compile.html"><strong aria-hidden="true">6.1.1.</strong> caramel compile</a></li><li class="chapter-item expanded "><a href="reference/cli/fmt.html"><strong aria-hidden="true">6.1.2.</strong> caramel fmt</a></li><li class="chapter-item expanded "><a href="reference/cli/sort-deps.html"><strong aria-hidden="true">6.1.3.</strong> caramel sort-deps</a></li><li class="chapter-item expanded "><a href="reference/cli/version.html"><strong aria-hidden="true">6.1.4.</strong> caramel version</a></li></ol></li><li class="chapter-item expanded "><a href="reference/lang/index.html"><strong aria-hidden="true">6.2.</strong> Language Features</a></li><li class="chapter-item expanded "><a href="reference/stdlib/index.html"><strong aria-hidden="true">6.3.</strong> Standard Library</a></li><li><ol class="section"><li class="chapter-item expanded "><a href="reference/stdlib/binary.html"><strong aria-hidden="true">6.3.1.</strong> Binary</a></li><li class="chapter-item expanded "><a href="reference/stdlib/calendar.html"><strong aria-hidden="true">6.3.2.</strong> Calendar</a></li><li class="chapter-item expanded "><a href="reference/stdlib/erlang.html"><strong aria-hidden="true">6.3.3.</strong> Erlang</a></li><li class="chapter-item expanded "><a href="reference/stdlib/ets.html"><strong aria-hidden="true">6.3.4.</strong> Ets</a></li><li class="chapter-item expanded "><a href="reference/stdlib/io.html"><strong aria-hidden="true">6.3.5.</strong> Io</a></li><li class="chapter-item expanded "><a href="reference/stdlib/lists.html"><strong aria-hidden="true">6.3.6.</strong> Lists</a></li><li class="chapter-item expanded "><a href="reference/stdlib/maps.html"><strong aria-hidden="true">6.3.7.</strong> Maps</a></li><li class="chapter-item expanded "><a href="reference/stdlib/process.html"><strong aria-hidden="true">6.3.8.</strong> Process</a></li><li class="chapter-item expanded "><a href="reference/stdlib/timer.html"><strong aria-hidden="true">6.3.9.</strong> Timer</a></li></ol></li><li class="chapter-item expanded "><a href="reference/otp/index.html"><strong aria-hidden="true">6.4.</strong> Typed OTP</a></li><li class="spacer"></li></ol></li><li class="chapter-item expanded "><a href="contrib/index.html"><strong aria-hidden="true">7.</strong> Contributing</a></li><li><ol class="section"><li class="chapter-item expanded "><a href="contrib/building.html"><strong aria-hidden="true">7.1.</strong> Building from Source</a></li><li class="chapter-item expanded "><a href="contrib/styleguide.html"><strong aria-hidden="true">7.2.</strong> Style guide</a></li><li class="chapter-item expanded "><a href="contrib/architecture.html"><strong aria-hidden="true">7.3.</strong> Architecutre</a></li></ol></li></ol>
            </div>
            <div id="sidebar-resize-handle" class="sidebar-resize-handle"></div>
        </nav>

        <div id="page-wrapper" class="page-wrapper">

            <div class="page">
                
                <div id="menu-bar-hover-placeholder"></div>
                <div id="menu-bar" class="menu-bar sticky bordered">
                    <div class="left-buttons">
                        <button id="sidebar-toggle" class="icon-button" type="button" title="Toggle Table of Contents" aria-label="Toggle Table of Contents" aria-controls="sidebar">
                            <i class="fa fa-bars"></i>
                        </button>
                        <button id="theme-toggle" class="icon-button" type="button" title="Change theme" aria-label="Change theme" aria-haspopup="true" aria-expanded="false" aria-controls="theme-list">
                            <i class="fa fa-paint-brush"></i>
                        </button>
                        <ul id="theme-list" class="theme-popup" aria-label="Themes" role="menu">
                            <li role="none"><button role="menuitem" class="theme" id="light">Light</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="rust">Rust</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="coal">Coal</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="navy">Navy</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="ayu">Ayu (default)</button></li>
                        </ul>
                        
                        <button id="search-toggle" class="icon-button" type="button" title="Search. (Shortkey: s)" aria-label="Toggle Searchbar" aria-expanded="false" aria-keyshortcuts="S" aria-controls="searchbar">
                            <i class="fa fa-search"></i>
                        </button>
                        
                    </div>

                    <h1 class="menu-title">
                      <img width="32px" src="/assets/isotype.png"> </img> Caramel
                    </h1>

                    <div class="right-buttons">
                        
                        <a href="print.html" title="Print this book" aria-label="Print this book">
                            <i id="print-button" class="fa fa-print"></i>
                        </a>
                        
                        
                        <a href="https://github.com/AbstractMachinesLab/caramel" title="Git repository" aria-label="Git repository">
                            <i id="git-repository-button" class="fa fa-github"></i>
                        </a>
                        
                    </div>
                </div>

                
                <div id="search-wrapper" class="hidden">
                    <form id="searchbar-outer" class="searchbar-outer">
                        <input type="search" name="search" id="searchbar" name="searchbar" placeholder="Search this book ..." aria-controls="searchresults-outer" aria-describedby="searchresults-header">
                    </form>
                    <div id="searchresults-outer" class="searchresults-outer hidden">
                        <div id="searchresults-header" class="searchresults-header"></div>
                        <ul id="searchresults">
                        </ul>
                    </div>
                </div>
                

                <!-- Apply ARIA attributes after the sidebar and the sidebar toggle button are added to the DOM -->
                <script type="text/javascript">
                    document.getElementById('sidebar-toggle').setAttribute('aria-expanded', sidebar === 'visible');
                    document.getElementById('sidebar').setAttribute('aria-hidden', sidebar !== 'visible');
                    Array.from(document.querySelectorAll('#sidebar a')).forEach(function(link) {
                        link.setAttribute('tabIndex', sidebar === 'visible' ? 0 : -1);
                    });
                </script>

                <div id="content" class="content">

                    <main>
                        <blockquote>
<p><strong>NOTE</strong>: this manual is a work in progress. Please let us know if you think
something is missing by <a href="https://github.com/AbstractMachinesLab/caramel/issues/new">filing an
issue</a>, or join our <a href="https://github.com/AbstractMachinesLab/caramel/discussions/45">Discord server.</a></p>
</blockquote>

                        <h1><a class="header" href="#introduction" id="introduction">Introduction</a></h1>
<p>Caramel is a functional language for building type-safe, scalable, and
maintainable applications.</p>
<p>It is built in <a href="https://ocaml.org">OCaml üê´</a> and maintained by <a href="https://github.com/AbstractMachinesLab">Abstract
Machines</a>.</p>
<p>Caramel leverages:</p>
<ul>
<li>
<p>the OCaml compiler, to provide you with a pragmatic type system and
industrial-strength type safety.</p>
</li>
<li>
<p>the Erlang VM, known for running low-latency, distributed, and fault-tolerant
systems used in a wide range of industries.</p>
</li>
</ul>
<p>Check out the <a href="./changelog/v0.1.0.html">CHANGELOG</a> to see what's new.</p>
<p>For installation instructions see <a href="./getting-started/installation.html">Installation</a>.</p>
<h2><a class="header" href="#feature-highlights" id="feature-highlights">Feature highlights</a></h2>
<ul>
<li>Excellent type-inferece, so you never need to annotate your code</li>
<li>Zero-cost type-safe interop with most existing Erlang and Elixir code</li>
<li>Has a reviewed standard library included</li>
<li>Supports sources in OCaml (and soon Reason syntax too)</li>
<li>Ships a single executable (<code>caramel</code>)</li>
<li>Has a built-in formatter (<code>caramel fmt</code>)</li>
</ul>
<h2><a class="header" href="#philosophy--goals" id="philosophy--goals">Philosophy &amp; Goals</a></h2>
<p>Caramel aims to make building type-safe concurrent programs a productive and
fun experience.</p>
<p>Caramel should let anyone with existing OCaml or Reason experience be up and
running without having to relearn the entire languages.</p>
<p>Caramel strives to integrate with the larger ecosystem of BEAM languages, like
Erlang, Elixir, Gleam, Purerl, LFE, and Hamler. </p>
<p>Caramel should be a batteries included environment where you pay only for what
you use.</p>
<h1><a class="header" href="#getting-started" id="getting-started">Getting Started</a></h1>
<ul>
<li><a href="getting-started/./installation.html">Installation</a></li>
<li><a href="getting-started/./first-steps.html">First steps</a></li>
<li><a href="getting-started/./how-caramel-works.html">How Caramel Works</a></li>
</ul>
<h1><a class="header" href="#installation" id="installation">Installation</a></h1>
<p>Caramel works on macOS, Linux, and Windows. It is a single binary, and it has no
external dependencies.</p>
<h3><a class="header" href="#using-a-package-manager" id="using-a-package-manager">Using a package manager</a></h3>
<p>If you are an <strong>Elixir programmer</strong>, Caramel can be installed with <code>mix</code>, just include the mix plugin in your project as a dependency:</p>
<pre><code class="language-elixir">{:mix_caramel, &quot;~&gt; 0.2.0&quot;}
</code></pre>
<p>If you are an <strong>Erlang programmer</strong>, Caramel can be installed with <code>rebar3</code>, just include the rebar3 plugin in your project as a dependency:</p>
<pre><code class="language-erlang">{plugins, [
  {rebar3_caramel, &quot;.*&quot;, {git, &quot;https://github.com/AbstractMachinesLab/rebar3_caramel.git&quot;, {branch, &quot;main&quot;}}}
]}.
</code></pre>
<p>If you are an <strong>OCaml programmer</strong>, Caramel can be installed with <code>opam</code>.</p>
<pre><code class="language-sh">opam install caramel
</code></pre>
<p><strong>Other platforms.</strong> If you'd like Caramel to be easier to install in your favorite platform, feel
free to <a href="https://github.com/AbstractMachinesLab/caramel/issues/new">Open a Github
Issue</a> and we can
talk about making it happen.</p>
<h3><a class="header" href="#manual-binary-installation" id="manual-binary-installation">Manual binary installation</a></h3>
<p>You can manuall install Caramel as well on Windows, macOS, or Linux by downloading
the zipped release from Github:
<a href="https://github.com/AbstractMachinesLab/caramel/releases/#user-content-assets">github.com/AbstractMachines/caramel/releases</a>.</p>
<h3><a class="header" href="#install-from-sources" id="install-from-sources">Install from Sources</a></h3>
<p>Check the <a href="getting-started//contrib/building.html">Building from Source</a> section for up to
date instructions.</p>
<p>If you have Rust and the source code of Caramel, you can install it by running <code>make install</code>.</p>
<h1><a class="header" href="#first-steps" id="first-steps">First Steps</a></h1>
<p>This section teaches you some of the fundamentals of Caramel.</p>
<blockquote>
<p><em>NOTE</em>: this section is using a standard library that mostly reflects how
Erlang works. We are working on a Standard Library that feels more idiomatic
to Caramel.</p>
</blockquote>
<p>It assumes you have some prior knowledge of functional programming, like
Erlang or Elixir, and some knowledge of static typing, like from TypeScript
or Java.</p>
<p><strong>Steps</strong></p>
<ul>
<li><a href="getting-started/first-steps.html#hello-world">Hello World</a></li>
<li><a href="getting-started/first-steps.html#say-hello">Say Hello</a></li>
<li><a href="getting-started/first-steps.html#working-with-types">Working with Types</a></li>
<li>Custom Types</li>
<li>Processes and Message Passing</li>
</ul>
<h3><a class="header" href="#prerequisites" id="prerequisites">Prerequisites</a></h3>
<p>You will need a working Erlang/OTP installation. You can get one from your
package manager:</p>
<pre><code># For Homebrew on OS X
brew install erlang

# For Ubuntu and Debian
apt-get install erlang

# For Fedora
yum install erlang

# For FreeBSD
pkg install erlang
</code></pre>
<h2><a class="header" href="#hello-world" id="hello-world">Hello World</a></h2>
<p>Caramel is a language that relies on the Erlang VM, just like Elixir or
Gleam. This means that we need to compile our code, and run it from within
Erlang.</p>
<p>Let's write a Hello World example:</p>
<pre><code class="language-ocaml">(* file: hello_world.ml *)
let main _ = Io.format &quot;~s~n&quot; [&quot;Hello World&quot;]
</code></pre>
<p>We can compile it as follows:</p>
<pre><code class="language-bash">$ caramel compile hello_world.ml
Compiling hello_world.erl OK
</code></pre>
<p>And run it with <code>escript</code>:</p>
<pre><code>$ escript hello_world.erl
Hello World
</code></pre>
<p><code>escript</code> is an Erlang utility to run an Erlang program as a script. It
defaults to running the <code>main/1</code> function of a module, and it passes all
command line arguments to it as a list of strings.</p>
<p>We can also load and run this module from a regular Erlang shell.</p>
<pre><code>$ erl
Erlang/OTP 23 [erts-11.1.5] [source] [64-bit] [smp:64:64] [ds:64:64:10]
[async-threads:1] [hipe]

Eshell V11.1.5  (abort with ^G)
1&gt; c(hello_world).
{ok,hello_world}
2&gt; hello_world:main([]).
Hello World
ok
</code></pre>
<h2><a class="header" href="#say-hello" id="say-hello">Say Hello!</a></h2>
<p>For our next example, we will take a list of names and will say hello to each of them.</p>
<pre><code class="language-ocaml">(* file: say_hello.ml *)

(* This function is recursive, so we must mark it with `let rec` *)
let rec say_hello names =

  (* We can use `match ... with` to inspect values like a Switch/Case *)
  match names with

  (* If there are no names, then the list is empty! and we're done *)
  | [] -&gt;
      (* We return a *unit* (the empty parens: ()). This is the closest we have
       * in Caramel to the usual `:ok` or `ok` atoms returned in Elixir / Erlang
       * to indicate that nothing happened, but everything's okay
       *)
      ()

  (* If there is at least one name, we can proceed... *)
  | n :: names' -&gt;
      Io.format &quot;Hello, ~s!\n&quot; [n];
      say_hello names'

let main args = say_hello args
</code></pre>
<p>Lets run this program now:</p>
<pre><code>$ escript say_hello.erl Joe Robert Mike
Hello, Joe!
Hello, Robert!
Hello, Mike!
</code></pre>
<h2><a class="header" href="#working-with-types" id="working-with-types">Working with Types</a></h2>
<p>We said before that Caramel is a typed language, but we haven't seen any
types at work so far. How is this possible?</p>
<p>Caramel is a strict subset of OCaml and it has excellent type-inference. This
means that Caramel has <strong>figured out the types for us</strong>.</p>
<blockquote>
<p><strong>NOTE</strong>: type inference is great, but sometimes it makes for less clear code
than it should, consider annotating for clarity whenever some things start
getting complex!</p>
</blockquote>
<p>Let's write a program now that will add together 2 numbers, ignoring their
decimals.</p>
<p>Our test cases will be:</p>
<ul>
<li><code>10 + 2 = 12</code></li>
<li><code>10 + 2.7 = 12</code></li>
</ul>
<pre><code class="language-ocaml">(* file: calc_add.ml *)
let main (a :: b :: _) =

  (* First we will try to convert our strings to integers *)
  let a_int = Erlang.list_to_integer a in
  let b_int = Erlang.list_to_integer b in

  (* Then we will add them both together *)
  let result = a_int + b_int in

  (* Finally we print out the results *)
  Io.format &quot;~p + ~p = ~p\n&quot; [a_int; b_int; result]
</code></pre>
<p>We can call it and see if it works:</p>
<pre><code class="language-bash">$ escript calc_add.erl 10 2
10 + 2 = 12
</code></pre>
<p>But what happens when we try to add <code>10</code> and <code>2.7</code>?</p>
<pre><code class="language-bash">Œª escript calc_add.erl 10 2.7
escript: exception error: bad argument
  in function  list_to_integer/1
     called as list_to_integer(&quot;2.7&quot;)
  in call from erl_eval:do_apply/6 (erl_eval.erl, line 680)
  in call from erl_eval:expr/5 (erl_eval.erl, line 449)
  in call from escript:eval_exprs/5 (escript.erl, line 872)
  in call from erl_eval:local_func/6 (erl_eval.erl, line 567)
  in call from escript:interpret/4 (escript.erl, line 788)
  in call from escript:start/1 (escript.erl, line 277)
  in call from init:start_em/1
</code></pre>
<p>The <code>Erlang.list_to_integer/1</code> function tries to parse a string into an
Integer, not a Float. Since Erlang makes a distinction between those at this
level, we have to use another function for this: <code>Erlang.list_to_float/1</code>.</p>
<p>Lets change our second value to be parsed as a float:</p>
<pre><code class="language-ocaml">(* ... *)
let b_int = Erlang.list_to_float b in
(* ... *)
</code></pre>
<p>When we try to compile, Caramel will show us an error message!</p>
<pre><code class="language-bash">$ caramel compile calc_add.ml
File &quot;fs3_calc_add_tagged.ml&quot;, line 8, characters 23-28:
Error: This expression has type float but an expression was expected of type
         int
</code></pre>
<p>Caramel has figured out that you are trying to add a float and an integer
together and its telling you that it can't <em>just do that</em>. We'll have to turn
our float into an integer, or turn our integer into a float, to be able to add
them together.</p>
<blockquote>
<p><strong>NOTE</strong>: Errors at the moment have the exact same copy and information as
errors from the OCaml compiler. Over time this will be changed.</p>
</blockquote>
<h2><a class="header" href="#custom-types" id="custom-types">Custom Types</a></h2>
<h2><a class="header" href="#processes-and-message-passing" id="processes-and-message-passing">Processes and Message Passing</a></h2>
<h2><a class="header" href="#a-glimpse-into-otp" id="a-glimpse-into-otp">A Glimpse into OTP</a></h2>
<h1><a class="header" href="#v010" id="v010">v0.1.0</a></h1>
<h2><a class="header" href="#manual" id="manual">Manual</a></h2>
<h2><a class="header" href="#caramel-formatter" id="caramel-formatter">Caramel Formatter</a></h2>
<h2><a class="header" href="#standard-library" id="standard-library">Standard Library</a></h2>
<h1><a class="header" href="#v010-1" id="v010-1">v0.1.0</a></h1>
<h2><a class="header" href="#manual-1" id="manual-1">Manual</a></h2>
<h2><a class="header" href="#caramel-formatter-1" id="caramel-formatter-1">Caramel Formatter</a></h2>
<h2><a class="header" href="#standard-library-1" id="standard-library-1">Standard Library</a></h2>
<h1><a class="header" href="#v0014-website-split-erlang-library-proper-exit-codes-and-better-runtime-support" id="v0014-website-split-erlang-library-proper-exit-codes-and-better-runtime-support">v0.0.14: Website, split Erlang library, proper exit codes, and better runtime support</a></h1>
<ul>
<li>
<p>erlang: the Erlang library included, with a lexer/parser/AST/printer
for Standard Erlang, is now completely split from the Caramel code and
will be published to opam shortly.</p>
</li>
<li>
<p>caramelc: will return exit code 0 if everything went well. Otherwise
expect a non-zero status!</p>
</li>
<li>
<p>stdlib: remove dependency on the Erlang AST printer for parts of the
runtime (like the <code>recv</code> function), and instead include the relevant
<code>.erl</code> sources as part of the packed stdlib.</p>
</li>
<li>
<p>docs: better contribution notes, documenting the release flow and
saying a word about the rationale behind it. I've also put together a
small website for Caramel here: https://caramel.abstractmachines.dev</p>
</li>
<li>
<p>examples: the echo tcp server has been refactored to make it harder to
accidentally override the <code>gen_tcp</code> module that is shipped with Erlang.
We'll have to figure out a nice way to prevent these things from
happening, which may just mean using all the modules on the Stdlib to
avoid redefinition.</p>
</li>
<li>
<p>ci: several changes to CI to ensure we can release the <code>erlang</code>
library to opam.</p>
</li>
</ul>
<h1><a class="header" href="#guides" id="guides">Guides</a></h1>
<h1><a class="header" href="#syntax-cheatsheet" id="syntax-cheatsheet">Syntax Cheatsheet</a></h1>
<p>Here is a comparison between common Erlang and Elixir syntaxes and the OCaml
and Reason syntaxes that are supported by Caramel.</p>
<h2><a class="header" href="#types" id="types">Types</a></h2>
<h3><a class="header" href="#variants-and-unions" id="variants-and-unions">Variants and Unions</a></h3>
<p><strong>Erlang</strong>:</p>
<pre><code class="language-erlang">-type bool() :: true | false.
-type foo() :: bar() | baz().
</code></pre>
<p><strong>Elixir</strong></p>
<pre><code class="language-elixir">@type bool() :: true | false
@type foo() :: bar() | baz()
</code></pre>
<p><strong>OCaml</strong></p>
<pre><code class="language-ocaml">type bool = True | False
type foo = Bar of bar | Baz of baz
type foo = [ `Bar of bar | `Baz of baz ]
type foo = [ bar | baz ] (* for when bar and baz are polymorphic variants *)
</code></pre>
<h3><a class="header" href="#records" id="records">Records</a></h3>
<p><strong>Erlang</strong>:</p>
<pre><code class="language-erlang">-type pair(A, B) :: #{ fst =&gt; A, snd =&gt; B }.
</code></pre>
<p><strong>Elixir</strong></p>
<pre><code class="language-elixir">@type pair(a, b) :: %{ :fst =&gt; a(), :snd =&gt; b() }
</code></pre>
<p><strong>OCaml</strong></p>
<pre><code class="language-ocaml">type ('a, 'b) pair = { fst : 'a; snd : 'b }
</code></pre>
<h2><a class="header" href="#expressions-and-values" id="expressions-and-values">Expressions and Values</a></h2>
<h3><a class="header" href="#atoms" id="atoms">Atoms</a></h3>
<table><thead><tr><th>Erlang</th><th>Elixir</th><th>OCaml</th><th>Reason</th><th>Description</th></tr></thead><tbody>
<tr><td><code>ok</code></td><td><code>:ok</code></td><td><code>`ok</code></td><td><code>`ok</code></td><td>Atoms in Caramel are treated as polymorphic variants.</td></tr>
<tr><td><code>'ok'</code></td><td><code>:'ok'</code></td><td>---</td><td>---</td><td>Quoted atoms are unsupported in Caramel.</td></tr>
</tbody></table>
<h3><a class="header" href="#comments" id="comments">Comments</a></h3>
<table><thead><tr><th>Erlang</th><th>Elixir</th><th>OCaml</th><th>Reason</th></tr></thead><tbody>
<tr><td><code>% comment</code></td><td><code># comment</code></td><td><code>(* comment *)</code></td><td><code>// comment</code></td></tr>
</tbody></table>
<h3><a class="header" href="#variables" id="variables">Variables</a></h3>
<table><thead><tr><th>Erlang</th><th>Elixir</th><th>OCaml</th><th>Reason</th></tr></thead><tbody>
<tr><td><code>A = 1</code></td><td><code>a = 1</code></td><td><code>let a = 1</code></td><td><code>let a = 1</code></td></tr>
<tr><td><code>A2 = A + 1</code></td><td><code>a = 1</code></td><td><code>let a' = a + 1</code></td><td><code>let a' = a + 1</code></td></tr>
</tbody></table>
<h3><a class="header" href="#binary-strings-and-charlists" id="binary-strings-and-charlists">Binary Strings, and Charlists</a></h3>
<table><thead><tr><th>Erlang</th><th>Elixir</th><th>OCaml</th><th>Reason</th></tr></thead><tbody>
<tr><td><code>&lt;&lt;&quot;binary&quot;&gt;&gt;</code></td><td><code>&quot;binary&quot;</code></td><td><code>&quot;binary&quot;</code></td><td><code>&quot;binary&quot;</code></td></tr>
<tr><td><code>&quot;string&quot;</code></td><td><code>'binary'</code></td><td><code>['b'; 'i'; 'n'; 'a'; 'r'; 'y']</code></td><td><code>['b', 'i', 'n', 'a', 'r', 'y']</code></td></tr>
</tbody></table>
<h3><a class="header" href="#function-calls" id="function-calls">Function Calls</a></h3>
<table><thead><tr><th>Erlang</th><th>Elixir</th><th>OCaml</th><th>Reason</th></tr></thead><tbody>
<tr><td><code>Lambda()</code></td><td><code>lambda.()</code></td><td><code>lambda ()</code></td><td><code>lambda()</code></td></tr>
<tr><td><code>local()</code></td><td><code>local()</code></td><td><code>local ()</code></td><td><code>local()</code></td></tr>
<tr><td><code>mod:fn()</code></td><td><code>Mod.fn()</code></td><td><code>Mod.fn ()</code></td><td><code>Mod.fn()</code></td></tr>
<tr><td><code>A:F()</code></td><td><code>apply(A, F, [])</code></td><td>---</td><td>---</td></tr>
</tbody></table>
<p>Dynamically dispatched calles are not supported in Caramel, because we can't
know the type of the arguments they will have, or the type of the value they
would return.</p>
<h3><a class="header" href="#if-expressions" id="if-expressions">If expressions</a></h3>
<p><strong>Erlang</strong>:</p>
<pre><code class="language-erlang">if 
  Foo -&gt; Bar;
  _ -&gt; Baz
end.
</code></pre>
<p><strong>Elixir</strong></p>
<pre><code class="language-elixir">if(foo, do: bar, else: baz)

if foo do
  bar
else 
  baz
end
</code></pre>
<p><strong>OCaml</strong></p>
<pre><code class="language-ocaml">if foo then bar else baz
</code></pre>
<p><strong>Reason</strong></p>
<pre><code class="language-reason">foo ? bar : baz
</code></pre>
<h3><a class="header" href="#match--case--switch-expression" id="match--case--switch-expression">Match / Case / Switch expression</a></h3>
<p><strong>Erlang</strong>:</p>
<pre><code class="language-erlang">case Foo of
  Bar -&gt; Baz
end.
</code></pre>
<p><strong>Elixir</strong></p>
<pre><code class="language-elixir">case foo do
  bar -&gt; baz
end
</code></pre>
<p><strong>OCaml</strong></p>
<pre><code class="language-ocaml">match foo with
| bar -&gt; baz
</code></pre>
<p><strong>Reason</strong></p>
<pre><code class="language-reason">switch foo {
| bar =&gt; baz
}
</code></pre>
<h1><a class="header" href="#using-caramel-with-rebar3" id="using-caramel-with-rebar3">Using Caramel with Rebar3</a></h1>
<h1><a class="header" href="#using-caramel-with-zap" id="using-caramel-with-zap">Using Caramel with Zap</a></h1>
<h1><a class="header" href="#using-caramel-with-zap-1" id="using-caramel-with-zap-1">Using Caramel with Zap</a></h1>
<h1><a class="header" href="#calling-erlang-code" id="calling-erlang-code">Calling Erlang code</a></h1>
<h1><a class="header" href="#calling-elixir-code" id="calling-elixir-code">Calling Elixir code</a></h1>
<h1><a class="header" href="#examples" id="examples">Examples</a></h1>
<h1><a class="header" href="#hello-joe" id="hello-joe">Hello, Joe!</a></h1>
<p>The BEAM community has had a tradition of writing Hello World programs where we
say Hello to <a href="https://en.wikipedia.org/wiki/Joe_Armstrong_(programmer)">Joe
Armstrong</a>, one of
the creators or <a href="https://erlang.org">Erlang</a>.</p>
<p>We can do this by creating a new file, called <code>hello_joe.ml</code> with the following
contents:</p>
<pre><code class="language-ocaml">let hello () = Io.format &quot;~p&quot; [&quot;Hello, Joe!&quot;]
</code></pre>
<p>Now we can compile this by calling <code>caramel compile hello_joe.ml</code>:</p>
<pre><code class="language-bash">$ ls
hello_joe.ml
$ caramel compile hello_joe.ml
$ ls
hello_joe.ml  hello_joe.erl
</code></pre>
<p>Our new compiled file, <code>hello_joe.erl</code> should looks like this:</p>
<pre><code class="language-erlang">% Source code Generated by Caramel
-module(hello_joe).

-export([hello/0]).

hello() -&gt; io:format(&lt;&lt;&quot;~p&quot;&gt;&gt;, [&lt;&lt;&quot;Hello, Joe!&quot;&gt;&gt;]).
</code></pre>
<p>Now we can compile and run this Erlang code </p>
<h1><a class="header" href="#simple-http-echo-server" id="simple-http-echo-server">Simple HTTP Echo Server</a></h1>
<pre><code class="language-ocaml">(* file: http_echo.ml *)

let handle conn =
  Gen_tcp.send conn &quot;hello world&quot;;
  Gen_tcp.close conn

(* this function will actually spawn new processes per connection, so we
   can easily handle millions of concurrent connections *)
let rec loop socket =
  let Ok conn = Gen_tcp.accept socket in
  let handler = Process.make (fun _self _recv -&gt; handle conn ) in
  Gen_tcp.controlling_process conn handler;
  loop socket

let start port = Process.make (fun _self _recv -&gt;
  let Ok socket = Gen_tcp.listen port [Active false; Packet Http] in
  loop socket)
</code></pre>
<h1><a class="header" href="#reference" id="reference">Reference</a></h1>
<h1><a class="header" href="#caramel" id="caramel">caramel</a></h1>
<pre><code>NAME
       caramel - Caramel compiler

SYNOPSIS
       caramel COMMAND ...

DESCRIPTION
       Caramel is a functional language for building type-safe, scalable, and
       maintainable applications.

COMMANDS
       compile
           Compile Caramel code to run on the Erlang VM.

       fmt Format Caramel code.

       parse
           (UNSTABLE) Helper command to parse sources and dump ASTs

       sort-deps
           Sort OCaml files by their dependencies on each other.

       version
           Show version information.

OPTIONS
       --help[=FMT] (default=auto)
           Show this help in format FMT. The value FMT must be one of `auto',
           `pager', `groff' or `plain'. With `auto', the format is `pager` or
           `plain' whenever the TERM env var is `dumb' or undefined.

       --version
           Show version information.

SEE ALSO
       ocaml(1) erlang

AUTHORS
       Leandro Ostera.

LICENSE
       Copyright (C) 2020-present, Abstract Machines Lab Sweden AB

       Caramel is licensed under Apache License 2.0
</code></pre>
<h1><a class="header" href="#caramel-compile" id="caramel-compile">caramel compile</a></h1>
<pre><code>NAME
       caramel-compile - Compile Caramel code to run on the Erlang VM.

SYNOPSIS
       caramel compile [OPTION]... SOURCES...

DESCRIPTION
        The Caramel takes as input OCaml sources and compiles them to Erlang
       code. 

ARGUMENTS
       SOURCES (required)
           A list of source files to compile

OPTIONS
       -d, --dump-ast
           Use this flag to print out to standard output the ASTs of the
           different representations being used during compilation. This is
           NOT suitable for programmatic usage, and its mostly used for
           debugging the compiler itself.

       --help[=FMT] (default=auto)
           Show this help in format FMT. The value FMT must be one of `auto',
           `pager', `groff' or `plain'. With `auto', the format is `pager` or
           `plain' whenever the TERM env var is `dumb' or undefined.

       --no-stdlib
           Use this flag to compile sources without opening the Standard
           Library by default.

       --stdlib-path=VAL (absent=/home/ostera/.opam/4.11.1/lib/caramel/stdlib
       or CARAMEL_STDLIB_PATH env)

       --version
           Show version information.

ENVIRONMENT
       These environment variables affect the execution of compile:

       CARAMEL_STDLIB_PATH
           See option --stdlib-path.

SEE ALSO
       ocaml(1) erlang

AUTHORS
       Leandro Ostera.

LICENSE
       Copyright (C) 2020-present, Abstract Machines Lab Sweden AB

       Caramel is licensed under Apache License 2.0
</code></pre>
<h1><a class="header" href="#caramel-fmt" id="caramel-fmt">caramel fmt</a></h1>
<pre><code>NAME
       caramel-fmt - Format Caramel code.

SYNOPSIS
       caramel fmt [OPTION]... SOURCES...

DESCRIPTION
        Reformats Caramel source code. 

ARGUMENTS
       SOURCES (required)
           A list of source files to format

OPTIONS
       --help[=FMT] (default=auto)
           Show this help in format FMT. The value FMT must be one of `auto',
           `pager', `groff' or `plain'. With `auto', the format is `pager` or
           `plain' whenever the TERM env var is `dumb' or undefined.

       --version
           Show version information.

SEE ALSO
       ocaml(1) erlang

AUTHORS
       Leandro Ostera.

LICENSE
       Copyright (C) 2020-present, Abstract Machines Lab Sweden AB

       Caramel is licensed under Apache License 2.0
</code></pre>
<h1><a class="header" href="#caramel-sort-deps" id="caramel-sort-deps">caramel sort-deps</a></h1>
<pre><code>NAME
       caramel-sort-deps - Sort OCaml files by their dependencies on each
       other.

SYNOPSIS
       caramel sort-deps [OPTION]... SOURCES...

DESCRIPTION
       

OPTIONS
       --help[=FMT] (default=auto)
           Show this help in format FMT. The value FMT must be one of `auto',
           `pager', `groff' or `plain'. With `auto', the format is `pager` or
           `plain' whenever the TERM env var is `dumb' or undefined.

       --version
           Show version information.

SEE ALSO
       ocaml(1) erlang

AUTHORS
       Leandro Ostera.

LICENSE
       Copyright (C) 2020-present, Abstract Machines Lab Sweden AB

       Caramel is licensed under Apache License 2.0
</code></pre>
<h3><a class="header" href="#caramel-version" id="caramel-version">caramel version</a></h3>
<pre><code>NAME
       caramel-version - Show version information.

SYNOPSIS
       caramel version [OPTION]... 

DESCRIPTION
        

OPTIONS
       --help[=FMT] (default=auto)
           Show this help in format FMT. The value FMT must be one of `auto',
           `pager', `groff' or `plain'. With `auto', the format is `pager` or
           `plain' whenever the TERM env var is `dumb' or undefined.

       --version
           Show version information.

SEE ALSO
       ocaml(1) erlang

AUTHORS
       Leandro Ostera.

LICENSE
       Copyright (C) 2020-present, Abstract Machines Lab Sweden AB

       Caramel is licensed under Apache License 2.0
</code></pre>
<h1><a class="header" href="#language-reference" id="language-reference">Language Reference</a></h1>
<h1><a class="header" href="#standard-library-2" id="standard-library-2">Standard Library</a></h1>
<h1><a class="header" href="#binary" id="binary">Binary</a></h1>
<h1><a class="header" href="#calendar" id="calendar">Calendar</a></h1>
<h1><a class="header" href="#erlang" id="erlang">Erlang</a></h1>
<h1><a class="header" href="#ets" id="ets">Ets</a></h1>
<h1><a class="header" href="#io" id="io">Io</a></h1>
<h1><a class="header" href="#lists" id="lists">Lists</a></h1>
<h1><a class="header" href="#maps" id="maps">Maps</a></h1>
<h1><a class="header" href="#process" id="process">Process</a></h1>
<h1><a class="header" href="#timer" id="timer">Timer</a></h1>
<h1><a class="header" href="#typed-otp" id="typed-otp">Typed OTP</a></h1>
<h1><a class="header" href="#contributing" id="contributing">Contributing</a></h1>
<h1><a class="header" href="#building-from-source" id="building-from-source">Building from Source</a></h1>
<p>Caramel is built with OCaml, so it needs a working opam installation.</p>
<p>One of our dependencies currently requires the Rust toolchain, so if you are
using <code>rustup</code>, the <code>stable</code> toolchain should suffice.</p>
<p>Additionally, we use <code>make</code>, since it makes our CI steps pretty minimal.</p>
<h3><a class="header" href="#getting-started-1" id="getting-started-1">Getting Started</a></h3>
<p>The next scripts show how to set up Caramel and create a release:</p>
<pre><code class="language-zsh"># install ocaml first
sh &lt;(curl -sL https://raw.githubusercontent.com/ocaml/opam/master/shell/install.sh)

# clone the repository
git clone git@github.com:AbstractMachinesLab/caramel.git
cd caramel

# install all required dependencies
make setup

# compile projects and runs the tests
make test

# installs project from sources
make install
</code></pre>
<h3><a class="header" href="#common-tasks" id="common-tasks">Common Tasks</a></h3>
<p>To bootstrap the repository, you can run <code>make setup build</code>.</p>
<p>To compile the manual, you can run <code>make manual</code>.</p>
<p>To run all the tests, you can run <code>make test</code>.</p>
<p>To install the local version, you can run <code>make install</code>.</p>
<p>To format all the code, you can run <code>make fmt</code>.</p>
<p>To create a release of Caramel, you can run <code>make release</code>, or <code>make release.win</code> on
Windows.</p>
<h1><a class="header" href="#style-guide" id="style-guide">Style guide</a></h1>
<h1><a class="header" href="#architecutre" id="architecutre">Architecutre</a></h1>

                    </main>

                    <nav class="nav-wrapper" aria-label="Page navigation">
                        <!-- Mobile navigation buttons -->
                        

                        

                        <div style="clear: both"></div>
                    </nav>
                </div>
            </div>

            <nav class="nav-wide-wrapper" aria-label="Page navigation">
                

                
            </nav>

        </div>

        

        

        
        <script type="text/javascript">
            window.playground_copyable = true;
        </script>
        

        

        
        <script src="elasticlunr.min.js" type="text/javascript" charset="utf-8"></script>
        <script src="mark.min.js" type="text/javascript" charset="utf-8"></script>
        <script src="searcher.js" type="text/javascript" charset="utf-8"></script>
        

        <script src="clipboard.min.js" type="text/javascript" charset="utf-8"></script>
        <script src="highlight.js" type="text/javascript" charset="utf-8"></script>
        <script src="book.js" type="text/javascript" charset="utf-8"></script>

        <!-- Custom JS scripts -->
        

        
        
        <script type="text/javascript">
        window.addEventListener('load', function() {
            window.setTimeout(window.print, 100);
        });
        </script>
        
        

    </body>
</html>
